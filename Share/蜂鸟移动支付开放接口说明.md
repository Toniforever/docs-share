
##蜂鸟移动支付接口使用

###第一步：客户端一键支付接口
只要调用SDK中的SBPayManager.onePay(String appid,String fee,int amount,String alias,SBPayCallListener sbPayCallListener)接口就可以实现一键支付，让用户毫无中断游戏感觉。

####1.导入蜂鸟移动支付SDK到开发工程
导入蜂鸟移动支付SDK开发包（以下简称SDK）到你开发的应用程序项目1）解压speedbirdpay.zip集成压缩包；
2）复制speedbirdpay.jar到工程libs/目录下
####2.配置AndroidManifest.xml#####权限配置：
	<uses-permission android:name="android.permission.INTERNET"/>
    <uses-permission android:name="android.permission.SEND_SMS"/>
    <uses-permission android:name="android.permission.READ_PHONE_STATE"/>
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>
    <uses-permission android:name="android.permission.ACCESS_WIFI_STATE"/>
    <uses-permission android:name="android.permission.WRITE_SMS"/>
    <uses-permission android:name="android.permission.READ_SMS"/>如下面所示:
    <?xml version="1.0" encoding="utf-8"?>
    <manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.jifei.simple"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="8" />

    <instrumentation
        android:name="android.test.InstrumentationTestRunner"
        android:targetPackage="com.jifei.simple" />
    <uses-permission android:name="android.permission.INTERNET"/>
    <uses-permission android:name="android.permission.SEND_SMS"/>
    <uses-permission android:name="android.permission.READ_PHONE_STATE"/>
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>
    <uses-permission android:name="android.permission.ACCESS_WIFI_STATE"/>
    <uses-permission android:name="android.permission.WRITE_SMS"/>
    <uses-permission android:name="android.permission.READ_SMS"/>

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <uses-library android:name="android.test.runner" />
	
        <activity
            android:name=".SimpleActivity"
            android:screenOrientation="portrait" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

    </manifest> ####3.添加代码SDK提供的API接口，集中在com.speedbird.pay.SBPayManager类里。
#####1）实现结果回调SBPayCallListener支付成功将会回调success(String transationId,String alias)方法，返回业务id和别名。支付失败将回调fail(int errorCode, String errorMsg)方法，返回错误码和错误信息。如下所示：
	public class PayCallBack implements SBPayCallListener{		...
		...		...		@Override
		public void success(String transationId,String alias) {

		}

		@Override
		public void fail(int errorCode, String errorMsg) {
		}	}
#####2）初始化计费管理器SBPayManager（建议在程序启动时初始化）

	SBPaymanager.onCreate(Context context);

#####3 注销计费管理器SBPayManager（建议在程序退出时中注销）
	SBPayManager.onDestroy();
#####4）调支付接口实现一键支付

	String fee="abc";
	int amount=1;
	String appid="abc";
	String alias="abc#123";
	PayCallBack paycallback=new paycallback();	SBPayManager.getInstance.onePay(appid,fee,amount,alias,paycallback);
参数说明

参数|是否必须|说明
---|-------|----
appid|是|分配给应用的标识
fee|是|计费点
amount|是|数量
alias|否|开发者自定义串，长度不能超过64个字符####4.错误码
错误码说明：
错误码|说明
---|----
1008|确认支付超时，订单支付可能未成功，请以后台通知为准
1101|appid不能为空！
1102|计费点标识不能为空！
1103|商品数量不能小于1！
1104|请在UI线程中调用计费接口！
1105|网络异常！
1106|发送短信超时，请检查手机是否信任应用，如果没有，请到：设置->安全->信任应用目录下，打开信任按钮！
1107|发送短信失败，请检查您的手机是否有手机卡或者信号是否正常！
1108|正在支付中.请等目前支付完后在试！
1109|请插入中国移动手机SIM卡！
1110|alias别名长度不能超过64个字符！

###第二步：服务端支付通知接口

当蜂鸟移动支付后台接收到短信网关的支付成功指令后，调用支付通知接口，告知应用平台支付成功。便于应用平台进行下一步逻辑的处理。

1）接口调用请求说明

http请求方式：POST

    http://NOTIFY_URL/notify

POST数据格式：JSON

POST数据例子：

    {"orderid":"123456789012345678","fee":"3yuan","amount":1,"payTime":"2014-04-05 12:20:20","appid":"1234567890","alias":"360market"}

参数|是否必须|说明
---|-------|----
appid|是|分配给应用的标识
alias|是|开发者自定义串，长度不能超过64个字符
orderid|是|成功支付的订单流水号
fee|是|计费点
amount|是|数量
payTime|是|成功支付时间
NOTIFY_URL|是|APP指定的通知URL地址

2）返回说明

正常时的返回JSON数据包示例：

    {"errcode":0,"errmsg":"接收到支付通知信息"}

参数|是否必须|说明
---|-------|----
errcode|是|错误代码
errmsg|是|错误代码信息描述